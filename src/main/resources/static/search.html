<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Search</title>
    <style>
      input[type='number']::-webkit-inner-spin-button,
      input[type='number']::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <p>
      <a href="./index.html">&laquo; Back</a>
    </p>

    <label for="search-user">ID:</label>
    <input type="number" id="search-user" />

    <table id="user-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Surname</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      const table = document.querySelector('#user-table');
      const tbody = table.querySelector('tbody');
      const fragment = document.createDocumentFragment();
      const input = document.querySelector('#search-user');

      input.oninput = ({ target: { value = '' } }) => {
        if (!value.trim()) {
          tbody.innerHTML = '';
        } else {
          fetch('https://thiss-rest-controllers.herokuapp.com/users/' + value)
            .then(response => response.json())
            .then(user => {
              const row = document.createElement('tr');

              Object.values(user).forEach(v => {
                const td = document.createElement('td');
                const text = document.createTextNode(v);

                td.appendChild(text);
                row.appendChild(td);
              });

              fragment.appendChild(row);

              tbody.innerHTML = '';
              tbody.appendChild(fragment);
            });
        }
      };
    </script>
  </body>
</html>
