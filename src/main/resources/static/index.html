<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Rest Controllers</title>
  </head>
  <body>
    <h1>Hello!</h1>

    <p>
      <a href="./search.html">Click here to search by id.</a>
    </p>
    <p>
      <a href="./insert.html">Click here to insert new user.</a>
    </p>

    <p>These are the existing users.</p>
    <table id="user-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Surname</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      const table = document.querySelector('#user-table');
      const tbody = table.querySelector('tbody');
      const fragment = document.createDocumentFragment();

      fetch('https://thiss-rest-controllers.herokuapp.com/users')
        .then(response => response.json())
        .then(users => {
          users.forEach(user => {
            const row = document.createElement('tr');

            Object.values(user).forEach(v => {
              const td = document.createElement('td');
              const text = document.createTextNode(v);

              td.appendChild(text);
              row.appendChild(td);
            });

            fragment.appendChild(row);
          });

          tbody.innerHTML = '';
          tbody.appendChild(fragment);
        });
    </script>
  </body>
</html>
